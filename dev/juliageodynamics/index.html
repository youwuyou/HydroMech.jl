<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>JuliaGeodynamics · HydroMech.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="HydroMech.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">HydroMech.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../2D-hydro-mechanical-solver/">2D-Hydro-mechanical solver</a></li><li><a class="tocitem" href="../3D-hydro-mechanical-solver/">3D-Hydro-mechanical solver</a></li></ul></li><li><span class="tocitem">Concepts</span><ul><li><a class="tocitem" href="../pseudo-transient-method/">Pseudo Transient Method</a></li><li><a class="tocitem" href="../iteration-parameters/">Iteration Parameters</a></li><li><a class="tocitem" href="../computational-earthquake-physics/">Computational Earthquake Physics</a></li></ul></li><li><a class="tocitem" href="../performance/">Performance</a></li><li><span class="tocitem">Benchmarks</span><ul><li><a class="tocitem" href="../benchmark-porosity-wave/">Porosity Wave</a></li><li><a class="tocitem" href="../benchmark-fluid-injection/">Fluid injection</a></li></ul></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="../roadmap/">Roadmap</a></li><li><a class="tocitem" href="../timeline/">Time line</a></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../hydromech/">HydroMech.jl</a></li><li><input class="collapse-toggle" id="menuitem-9-2" type="checkbox"/><label class="tocitem" for="menuitem-9-2"><span class="docs-label">PTsolvers/JustRelax.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../justrelax-overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-9-2-2" type="checkbox"/><label class="tocitem" for="menuitem-9-2-2"><span class="docs-label">Source code</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../justrelax-modules/">Modules</a></li><li><a class="tocitem" href="../justrelax-types/">Types</a></li></ul></li><li><a class="tocitem" href="../justrelax-Miniapps/">Miniapps</a></li><li><a class="tocitem" href="../justrelax-Testing/">Testing</a></li></ul></li><li><a class="tocitem" href="../parallelstencil/">ParallelStencil</a></li><li class="is-active"><a class="tocitem" href>JuliaGeodynamics</a></li></ul></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>JuliaGeodynamics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>JuliaGeodynamics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/youwuyou/HydroMech.jl/blob/main/docs/src/juliageodynamics.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="[GeoParams.jl](https://github.com/JuliaGeodynamics/GeoParams.jl.git)-API"><a class="docs-heading-anchor" href="#[GeoParams.jl](https://github.com/JuliaGeodynamics/GeoParams.jl.git)-API"><a href="https://github.com/JuliaGeodynamics/GeoParams.jl.git">GeoParams.jl</a> API</a><a id="[GeoParams.jl](https://github.com/JuliaGeodynamics/GeoParams.jl.git)-API-1"></a><a class="docs-heading-anchor-permalink" href="#[GeoParams.jl](https://github.com/JuliaGeodynamics/GeoParams.jl.git)-API" title="Permalink"></a></h1><h3 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h3><ul><li>[x] Functors to available creep laws</li><li>[x] Elasticity struct</li><li>[x] Interoperability with ParallelStencil.jl</li><li>[x] <code>compute_viscosity()</code> agnostic to input parameters</li><li>[x] composable custom creep law</li></ul><p>The following API is created using the docstrings avaliable within the <code>ParallelStencil.jl</code> package, and is included for convinience here for look-up purpose. Please refer to the official repository and ask the creator of the packages if anything is unclear.</p><p>&lt;!– </p><article class="docstring"><header><a class="docstring-binding" id="GeoParams.ConstTemp" href="#GeoParams.ConstTemp"><code>GeoParams.ConstTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ConstTemp(T=1000)</code></pre><p>Sets a constant temperature inside the box</p><p>Parameters:</p><ul><li>T : the value</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.HalfspaceCoolTemp" href="#GeoParams.HalfspaceCoolTemp"><code>GeoParams.HalfspaceCoolTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HalfspaceCoolTemp(Tsurface=0, Tmantle=1350, Age=60, Adiabat=0)</code></pre><p>Sets a halfspace temperature structure in plate</p><p>Parameters:</p><ul><li>Tsurface: surface temperature [C]</li><li>Tmantle:  mantle temperature [C]</li><li>Age:      Thermal Age of plate [Myrs]</li><li>Adiabat:  Mantle Adiabat [K/km]</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.LinTemp" href="#GeoParams.LinTemp"><code>GeoParams.LinTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LinTemp(Ttop=0, Tbot=1000)</code></pre><p>Sets a linear temperature structure from top to bottom</p><p>Parameters:</p><ul><li>Ttop: the value @ the top</li><li>Tbot: the value @ the bottom</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.CompTempStruct-Tuple{Any, ConstTemp}" href="#GeoParams.CompTempStruct-Tuple{Any, ConstTemp}"><code>GeoParams.CompTempStruct</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">CompTempStruct(Z, s::AbstractTempStruct)</code></pre><p>Returns a temperature vector that matches the coordinate vector and temperature structure that were passed in</p><p>Parameters:</p><ul><li>Z: vector with depth coordinates</li><li>s: Temperature structure (CostTemp, LinTemp, HalfspaceCoolTemp)</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.LithPres-NTuple{6, Any}" href="#GeoParams.LithPres-NTuple{6, Any}"><code>GeoParams.LithPres</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LithPres(MatParam, Phases, ρ, T, dz, g)</code></pre><p>Iteratively solves a 1D lithostatic pressure profile (compatible with temperature- and pressure-dependent densities)</p><p>Parameters:</p><ul><li>MatParam: a tuple of materials (including the following properties: Phase, Density)</li><li>Phases:   vector with the distribtion of phases</li><li>ρ:        density vector for initial guess(can be zeros)</li><li>T:        temperature vector</li><li>dz:       grid spacing</li><li>g:        gravitational accelaration</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.StrengthEnvelopeComp-Union{Tuple{U}, Tuple{N}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}, GeoParams.AbstractTempStruct}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}, GeoParams.AbstractTempStruct, Any}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}, GeoParams.AbstractTempStruct, Any, Int64}} where {N, U}" href="#GeoParams.StrengthEnvelopeComp-Union{Tuple{U}, Tuple{N}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}, GeoParams.AbstractTempStruct}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}, GeoParams.AbstractTempStruct, Any}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N}}, Vector{U}, GeoParams.AbstractTempStruct, Any, Int64}} where {N, U}"><code>GeoParams.StrengthEnvelopeComp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">StrengthEnvelopeComp(MatParam::NTuple{N, AbstractMaterialParamsStruct}, Thickness::Vector{U}, TempType::AbstractTempStruct=LinTemp(0C, 800C), ε=1e-15/s, nz::Int64=101) where {N, U}</code></pre><p>Calculates a 1D strength envelope. Pressure used for Drucker Prager plasticity is lithostatic. To visualize the results in a GUI, use StrengthEnvelopePlot.</p><p>Parameters:</p><ul><li>MatParam:  a tuple of materials (including the following properties: Phase, Density, CreepLaws, Plasticity)</li><li>Thickness: a vector listing the thicknesses of the respective layers (should carry units)</li><li>TempType:  the type of temperature profile (ConstTemp(), LinTemp(), HalfspaceCoolTemp())</li><li>ε:         background strainrate</li><li>nz:        optional argument controlling the number of points along the profile (default = 101)</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using GLMakie
julia&gt; MatParam = (SetMaterialParams(Name=&quot;UC&quot;, Phase=1, Density=ConstantDensity(ρ=2700kg/m^3), CreepLaws = SetDislocationCreep(&quot;Wet Quartzite | Ueda et al. (2008)&quot;), Plasticity = DruckerPrager(ϕ=30.0, C=10MPa)),
                   SetMaterialParams(Name=&quot;MC&quot;, Phase=2, Density=Density=ConstantDensity(ρ=2900kg/m^3), CreepLaws = SetDislocationCreep(&quot;Plagioclase An75 | Ji and Zhao (1993)&quot;), Plasticity = DruckerPrager(ϕ=20.0, C=10MPa)),
                   SetMaterialParams(Name=&quot;LC&quot;, Phase=3, Density=PT_Density(ρ0=2900kg/m^3, α=3e-5/K, β=1e-10/Pa), CreepLaws = SetDislocationCreep(&quot;Maryland strong diabase | Mackwell et al. (1998)&quot;), Plasticity = DruckerPrager(ϕ=30.0, C=10MPa)));
julia&gt; Thickness = [15,10,15]*km;

julia&gt; StrengthEnvelopeComp(MatParam, Thickness, LinTemp(), ε=1e-15/s)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.StrengthEnvelopePlot-Tuple{}" href="#GeoParams.StrengthEnvelopePlot-Tuple{}"><code>GeoParams.StrengthEnvelopePlot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">StrengthEnvelopePlot(MatParam, Thickness; TempType, nz)</code></pre><p>Requires GLMakie</p><p>Creates a GUI that plots a 1D strength envelope. In the GUI, temperature profile and strain rate can be adjusted. The Drucker-Prager plasticity uses lithostatic pressure.</p><p>Parameters:</p><ul><li>MatParam:  a tuple of materials (including the following properties: Phase, Density, CreepLaws, Plasticity)</li><li>Thickness: a vector listing the thicknesses of the respective layers (should carry units)</li><li>TempType:  the type of temperature profile (LinTemp=default, HalfspaceCoolTemp, ConstTemp)</li><li>nz:        optional argument controlling the number of points along the profile (default = 101)</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using GLMakie
julia&gt; MatParam = (SetMaterialParams(Name=&quot;UC&quot;, Phase=1, Density=ConstantDensity(ρ=2700kg/m^3), CreepLaws = SetDislocationCreep(&quot;Wet Quartzite | Ueda et al. (2008)&quot;), Plasticity = DruckerPrager(ϕ=30.0, C=10MPa)),
                   SetMaterialParams(Name=&quot;MC&quot;, Phase=2, Density=Density=ConstantDensity(ρ=2900kg/m^3), CreepLaws = SetDislocationCreep(&quot;Plagioclase An75 | Ji and Zhao (1993)&quot;), Plasticity = DruckerPrager(ϕ=20.0, C=10MPa)),
                   SetMaterialParams(Name=&quot;LC&quot;, Phase=3, Density=PT_Density(ρ0=2900kg/m^3, α=3e-5/K, β=1e-10/Pa), CreepLaws = SetDislocationCreep(&quot;Maryland strong diabase | Mackwell et al. (1998)&quot;), Plasticity = DruckerPrager(ϕ=30.0, C=10MPa)));
julia&gt; Thickness = [15,10,15]*km;

julia&gt; StrengthEnvelopePlot(MatParam, Thickness, LinTemp())</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_p_τij!-Union{Tuple{N}, Tuple{I}, Tuple{_T}, Tuple{AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{I}, Tuple{Vararg{AbstractMaterialParamsStruct, N}}, _T}} where {_T&lt;:Number, I&lt;:Integer, N}" href="#GeoParams.compute_p_τij!-Union{Tuple{N}, Tuple{I}, Tuple{_T}, Tuple{AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{I}, Tuple{Vararg{AbstractMaterialParamsStruct, N}}, _T}} where {_T&lt;:Number, I&lt;:Integer, N}"><code>GeoParams.compute_p_τij!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_p_τij!(Txx, Tyy, Txy, Tii, η_vep, P, Exx, Eyy, Exy, P_o, Txx_o, Tyy_o, Txy_o, phase, MatParam, dt)</code></pre><p>Computes 2D deviatoric stress components <code>(Txx,Tyy,Txy)</code> and pressure <code>P</code> given deviatoric strainrate components <code>(Exx,Eyy,Exy)</code> and old deviatoric stresses <code>(Txx_o, Tyy_o, Txy_o)</code> and old pressure <code>P_o</code> (only used for viscoelastic cases). Also returned are <code>Tii</code> (second invariant of the deviatoric stress tensor), and <code>η_vep</code> the viscoelastoplastic effective viscosity.  Also required as input is <code>MatParam</code>, the material parameters for every phase and <code>phase</code>, an integer array of <code>size(Exx)</code> that indicates the phase of every point.</p><p>This function assumes that strainrate points are collocated and that <code>Exx</code>,<code>Eyy</code>,<code>Exy</code> are at the same points.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_p_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{T, N2}}, T, Any, Tuple{Vararg{T, N2}}, I}} where {T, N1, N2, I&lt;:Integer}" href="#GeoParams.compute_p_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{T, N2}}, T, Any, Tuple{Vararg{T, N2}}, I}} where {T, N1, N2, I&lt;:Integer}"><code>GeoParams.compute_p_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">P,τij, τII = compute_p_τij(v::NTuple{N1,AbstractMaterialParamsStruct}, εij::NTuple{N2,T}, P_old::T, args, τij_old::NTuple{3,T}, phase::I)</code></pre><p>Computes deviatoric stress <code>τij</code> for given deviatoric strain rate <code>εij</code>, old stress <code>τij_old</code>, rheology <code>v</code> and arguments <code>args</code>. This is for a collocated grid case with a single phase <code>phase</code>. </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_p_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, T, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, Tuple{Vararg{Union{NTuple{4, I}, I}, N2}}}} where {T, N1, N2, I&lt;:Integer}" href="#GeoParams.compute_p_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, T, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, Tuple{Vararg{Union{NTuple{4, I}, I}, N2}}}} where {T, N1, N2, I&lt;:Integer}"><code>GeoParams.compute_p_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">τij, τII, η_eff = compute_p_τij(v::NTuple{N1,AbstractMaterialParamsStruct}, εij::NTuple, args, τij_old::NTuple, phases::NTuple)</code></pre><p>This computes pressure <code>p</code> and deviatoric stress components <code>τij</code>, their second invariant <code>τII</code>, and effective viscosity <code>η_eff</code> for given deviatoric strainrates <code>εij</code>, old stresses <code>τij_old</code>, <code>phases</code> (integer) for every point and arguments <code>args</code>. It handles staggered grids of various taste</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_p_τij-Union{Tuple{N}, Tuple{T}, Tuple{Any, Tuple{Vararg{T, N}}, T, Any, Tuple{Vararg{T, N}}}} where {T, N}" href="#GeoParams.compute_p_τij-Union{Tuple{N}, Tuple{T}, Tuple{Any, Tuple{Vararg{T, N}}, T, Any, Tuple{Vararg{T, N}}}} where {T, N}"><code>GeoParams.compute_p_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p,τij,τII = compute_p_τij(v, εij::NTuple{n,T}, P_old::T, args,  τij_old::NTuple{N,T})</code></pre><p>Computes pressure <code>p</code> and deviatoric stress <code>τij</code> for given deviatoric strain rate <code>εij</code>, old stress <code>τij_old</code>, rheology <code>v</code> and arguments <code>args</code>. This is for a case that all points are collocated and we have a single phase. </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_p_τij-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}, T, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}}} where {N, T}" href="#GeoParams.compute_p_τij-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}, T, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}}} where {N, T}"><code>GeoParams.compute_p_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p, τij, τII = compute_p_τij(v, εij::NTuple{N,Union{T,NTuple{4,T}}}, P_old::T, args, τij_old::NTuple{3,T})</code></pre><p>Computes deviatoric stress <code>τij</code> for given deviatoric strain rate <code>εij</code>, old stress <code>τij_old</code>, rheology <code>v</code> and arguments <code>args</code>. This is for a staggered grid case with a single phase. </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_p_τij_stagcenter!-Union{Tuple{N}, Tuple{I}, Tuple{_T}, Tuple{AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{I}, AbstractArray{I}, Tuple{Vararg{AbstractMaterialParamsStruct, N}}, _T}} where {_T&lt;:Number, I&lt;:Integer, N}" href="#GeoParams.compute_p_τij_stagcenter!-Union{Tuple{N}, Tuple{I}, Tuple{_T}, Tuple{AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{I}, AbstractArray{I}, Tuple{Vararg{AbstractMaterialParamsStruct, N}}, _T}} where {_T&lt;:Number, I&lt;:Integer, N}"><code>GeoParams.compute_p_τij_stagcenter!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_τij_stagcenter!(Txx, Tyy, Txy, Tii, η_vep,  P, Exx, Eyy, Exyv, P_o, Txx_o, Tyy_o, Txyv_o, phase_center, phase_vertex, MatParam, dt)</code></pre><p>Updates deviatoric stresses on a staggered grid in a centered based manner (averages strainrates/old stresses from vertices -&gt; centers). Take care of the sizes of the input matrixes:</p><ul><li><code>Txx</code>,<code>Tyy</code>,<code>Txy</code>,<code>Tii</code>,<code>P</code>: 2D matrixes of size (nx,ny) which describe updated deviatoric stress components (x,y,xy, 2nd invariant) at the center point</li><li><code>η_vep</code>: viscoelastoplastic viscosity @ center (nx,ny)</li><li><code>Exx</code>,<code>Eyy</code>,<code>P_o</code>: deviatoric strain rate components &amp; old pressure @ center</li><li><code>Exy</code>: shear strain rate @ vertices (nx+1,ny+1)</li><li><code>Txx_o</code>, <code>Tyy_o</code>: deviatoric stress normal components of last timestep at center (nx,ny)</li><li><code>Txy_o</code>: deviatoric stress shear components at vertices (nx+1,ny+1)</li><li><code>phase_center</code>: integer array with phase at center points (nx,ny)</li><li><code>phase_vertex</code>: integer array with phase at vertex points (nx+1,ny+1)</li><li><code>MatParam</code>: material parameter array that includes a <code>CompositeRheology</code> field which specifies the rheology for different phases</li><li><code>dt</code>: timestep </li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{T, N2}}, Any, Tuple{Vararg{T, N2}}, I}} where {T, N1, N2, I&lt;:Integer}" href="#GeoParams.compute_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{T, N2}}, Any, Tuple{Vararg{T, N2}}, I}} where {T, N1, N2, I&lt;:Integer}"><code>GeoParams.compute_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">τij, τII = compute_τij(v::NTuple{N1,AbstractMaterialParamsStruct}, εij::NTuple{N2,T}, args, τij_old::NTuple{3,T}, phase::I)</code></pre><p>Computes deviatoric stress <code>τij</code> for given deviatoric strain rate <code>εij</code>, old stress <code>τij_old</code>, rheology <code>v</code> and arguments <code>args</code>. This is for a collocated grid case with a single phase <code>phase</code>. </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, Tuple{Vararg{Union{NTuple{4, I}, I}, N2}}}} where {T, N1, N2, I&lt;:Integer}" href="#GeoParams.compute_τij-Union{Tuple{I}, Tuple{N2}, Tuple{N1}, Tuple{T}, Tuple{Tuple{Vararg{AbstractMaterialParamsStruct, N1}}, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N2}}, Tuple{Vararg{Union{NTuple{4, I}, I}, N2}}}} where {T, N1, N2, I&lt;:Integer}"><code>GeoParams.compute_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">τij, τII, η_eff = compute_τij(v::NTuple{N1,AbstractMaterialParamsStruct}, εij::NTuple, args, τij_old::NTuple, phases::NTuple)</code></pre><p>This computes deviatoric stress components <code>τij</code>, their second invariant <code>τII</code>, and effective viscosity <code>η_eff</code> for given deviatoric strainrates <code>εij</code>, old stresses <code>τij_old</code>, <code>phases</code> (integer) for every point and arguments <code>args</code>. This handles various staggered grid arrangements; if staggered components are given as <code>NTuple{4,T}</code>, they will be averaged. Note that the phase of all staggered points should be the same.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_τij-Union{Tuple{N}, Tuple{T}, Tuple{Any, Tuple{Vararg{T, N}}, Any, Tuple{Vararg{T, N}}}} where {T, N}" href="#GeoParams.compute_τij-Union{Tuple{N}, Tuple{T}, Tuple{Any, Tuple{Vararg{T, N}}, Any, Tuple{Vararg{T, N}}}} where {T, N}"><code>GeoParams.compute_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">τij,τII = compute_τij(v, εij::NTuple{n,T}, args, τij_old::NTuple{N,T})</code></pre><p>Computes deviatoric stress <code>τij</code> for given deviatoric strain rate <code>εij</code>, old stress <code>τij_old</code>, rheology <code>v</code> and arguments <code>args</code>. This is for a case that all points are collocated and we have a single phase. </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_τij-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}}} where {N, T}" href="#GeoParams.compute_τij-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}, Any, Tuple{Vararg{Union{NTuple{4, T}, T}, N}}}} where {N, T}"><code>GeoParams.compute_τij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">τij, τII = compute_τij(v, εij::NTuple{N,Union{T,NTuple{4,T}}}, args, τij_old::NTuple{3,T})</code></pre><p>Computes deviatoric stress <code>τij</code> for given deviatoric strain rate <code>εij</code>, old stress <code>τij_old</code>, rheology <code>v</code> and arguments <code>args</code>. This is for a staggered grid case with a single phase. </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.compute_τij_stagcenter!-Union{Tuple{N}, Tuple{I}, Tuple{_T}, Tuple{AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{I}, AbstractArray{I}, Tuple{Vararg{AbstractMaterialParamsStruct, N}}, _T}} where {_T&lt;:Number, I&lt;:Integer, N}" href="#GeoParams.compute_τij_stagcenter!-Union{Tuple{N}, Tuple{I}, Tuple{_T}, Tuple{AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{_T}, AbstractArray{I}, AbstractArray{I}, Tuple{Vararg{AbstractMaterialParamsStruct, N}}, _T}} where {_T&lt;:Number, I&lt;:Integer, N}"><code>GeoParams.compute_τij_stagcenter!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_τij_stagcenter!(Txx, Tyy, Txy, Tii, η_vep,  Exx, Eyy, Exyv, P, Txx_o, Tyy_o, Txyv_o, phase_center, phase_vertex, MatParam, dt)</code></pre><p>Updates deviatoric stresses on a staggered grid in a centered based manner (averages strainrates/old stresses from vertices -&gt; centers). Take care of the sizes of the input matrixes:</p><ul><li><code>Txx</code>,<code>Tyy</code>,<code>Txy</code>,<code>Tii</code>: 2D matrixes of size (nx,ny) which describe updated deviatoric stress components (x,y,xy, 2nd invariant) at the center point</li><li><code>η_vep</code>: viscoelastoplastic viscosity @ center (nx,ny)</li><li><code>Exx</code>,<code>Eyy</code>,<code>P</code>: deviatoric strain rate components &amp; pressure @ center </li><li><code>Exy</code>: shear strain rate @ vertices (nx+1,ny+1)</li><li><code>Txx_o</code>, <code>Tyy_o</code>: deviatoric stress normal components of last timestep at center (nx,ny)</li><li><code>Txy_o</code>: deviatoric stress shear components at vertices (nx+1,ny+1)</li><li><code>phase_center</code>: integer array with phase at center points (nx,ny)</li><li><code>phase_vertex</code>: integer array with phase at vertex points (nx+1,ny+1)</li><li><code>MatParam</code>: material parameter array that includes a <code>CompositeRheology</code> field which specifies the rheology for different phases</li><li><code>dt</code>: timestep </li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{NTuple{4, T}, NTuple{4, T}, NTuple{4, T}, Tuple{T, T, T}}} where T" href="#GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{NTuple{4, T}, NTuple{4, T}, NTuple{4, T}, Tuple{T, T, T}}} where T"><code>GeoParams.second_invariant_staggered</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">second_invariant_staggered(Axx::NTuple{4,T}, Ayy::NTuple{4,T}, Azz::NTuple{4,T}, Aij::NTuple{3,T}) where {T}</code></pre><p>Computes the second invariant of the 2D tensor <code>A</code> when its diagonal components  need to be maped from cell center to cell vertex. <code>Axx</code>, <code>Ayy</code>, and <code>Azz</code> are tuples containinig the diagonal terms of <code>A</code> at the cell centers around the i-th vertex., and <code>Aij</code> is a tuple that contains the off-diagonal components at the i-th vertex.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{NTuple{4, T}, NTuple{4, T}, Number}} where T" href="#GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{NTuple{4, T}, NTuple{4, T}, Number}} where T"><code>GeoParams.second_invariant_staggered</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">second_invariant_staggered(Axx::NTuple{4,T}, Ayy::NTuple{4,T}, Axy::Number) where {T}</code></pre><p>Computes the second invariant of the 2D tensor <code>A</code> when its diagonal components  need to be maped from cell center to cell vertex. <code>Axx</code>, and <code>Ayy</code> are tuples containinig the diagonal terms of <code>A</code> at the cell centers around the i-th vertex., and <code>Axy</code> is the xy component at the i-th vertex.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{Tuple{T, T, T}, NTuple{4, T}, NTuple{4, T}, NTuple{4, T}}} where T" href="#GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{Tuple{T, T, T}, NTuple{4, T}, NTuple{4, T}, NTuple{4, T}}} where T"><code>GeoParams.second_invariant_staggered</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">second_invariant_staggered(Aii::NTuple{3,T}, Ayz::NTuple{4,T}, Axz::NTuple{4,T}, Axy::NTuple{4,T}) where {T}</code></pre><p>Computes the second invariant of the 2D tensor <code>A</code> when its off-diagonal components  need to be maped from cell center to cell vertex. <code>Aii</code> is a tuple containinig the diagonal terms of <code>A</code> at the i-th vertex, and <code>Ayz</code>, <code>Axz</code>, and <code>Axy</code> are tuples that contain the off-diagonal components of the tensor at the cell centers around the i-th vertex.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{Tuple{T, T}, NTuple{4, T}}} where T" href="#GeoParams.second_invariant_staggered-Union{Tuple{T}, Tuple{Tuple{T, T}, NTuple{4, T}}} where T"><code>GeoParams.second_invariant_staggered</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">second_invariant_staggered(Aii::NTuple{2,T}, Axy::NTuple{4,T}) where {T}</code></pre><p>Computes the second invariant of the 2D tensor <code>A</code> when its off-diagonal components  need to be maped from cell center to cell vertex.  <code>Aii</code> is a tuple containinig the diagonal terms of <code>A</code> at the i-th vertex, and <code>Axy</code> is a tuple that contains <code>A_xy</code> at the cell centers around the i-th vertex.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.time_p_τII_0D!-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, Union{Tuple, CompositeRheology, Parallel}, Vector{T}, Vector{T}, Any, AbstractVector{T}}} where T" href="#GeoParams.time_p_τII_0D!-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, Union{Tuple, CompositeRheology, Parallel}, Vector{T}, Vector{T}, Any, AbstractVector{T}}} where T"><code>GeoParams.time_p_τII_0D!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">time_p_τII_0D!(P_vec::Vector{T}, τ_vec::Vector{T}, v::CompositeRheology, εII_vec::Vector{T}, εvol_vec::Vector{T}, args, t_vec::AbstractVector{T}) where {T}</code></pre><p>Computes stress-time evolution for a 0D (homogeneous) setup with given shear and volumetric strainrate vectors (which can vary with time).</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.time_p_τII_0D-Tuple{Union{Tuple, CompositeRheology, Parallel}, Number, Number, Any}" href="#GeoParams.time_p_τII_0D-Tuple{Union{Tuple, CompositeRheology, Parallel}, Number, Number, Any}"><code>GeoParams.time_p_τII_0D</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">t_vec, P_vec, τ_vec = time_p_τII_0D(v::CompositeRheology, εII::Number, εvol::Number, args; t=(0.,100.), τ0=0., nt::Int64=100)</code></pre><p>This performs a 0D constant strainrate experiment for a composite rheology structure <code>v</code>, and a given, constant, shear strainrate <code>εII</code> and volumetric strainrate <code>εvol</code>, as well as rheology arguments <code>args</code>. The initial stress <code>τ0</code>, the time range <code>t</code> and the number of timesteps <code>nt</code> can be modified </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.time_τII_0D!-Union{Tuple{T}, Tuple{N}, Tuple{Array{Tuple{Vararg{T, N}}, 1}, Vector{T}, Union{Tuple, CompositeRheology, Parallel}, Array{Tuple{Vararg{T, N}}, 1}, Any, AbstractVector{T}}} where {N, T}" href="#GeoParams.time_τII_0D!-Union{Tuple{T}, Tuple{N}, Tuple{Array{Tuple{Vararg{T, N}}, 1}, Vector{T}, Union{Tuple, CompositeRheology, Parallel}, Array{Tuple{Vararg{T, N}}, 1}, Any, AbstractVector{T}}} where {N, T}"><code>GeoParams.time_τII_0D!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">time_τII_0D!(τ_vec::Vector{NTuple{N,T}}, τII_vec::Vector{T}, v::Union{CompositeRheology,Tuple, Parallel}, ε_vec::Vector{NTuple{N,T}}, args, t_vec::AbstractVector{T}; verbose=false) where {N,T}</code></pre><p>Computes stress-time evolution for a 0D (homogeneous) setup with given strainrate tensor (which can vary with time).</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.time_τII_0D!-Union{Tuple{T}, Tuple{Vector{T}, Union{Tuple, CompositeRheology, Parallel}, Vector{T}, Any, AbstractVector{T}}} where T" href="#GeoParams.time_τII_0D!-Union{Tuple{T}, Tuple{Vector{T}, Union{Tuple, CompositeRheology, Parallel}, Vector{T}, Any, AbstractVector{T}}} where T"><code>GeoParams.time_τII_0D!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">time_τII_0D!(τ_vec::Vector{T}, v::CompositeRheology, εII_vec::Vector{T}, args, t_vec::AbstractVector{T}) where {T}</code></pre><p>Computes stress-time evolution for a 0D (homogeneous) setup with given strainrate vector (which can vary with time).</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.time_τII_0D-Tuple{Union{Tuple, CompositeRheology, Parallel}, Number, Any}" href="#GeoParams.time_τII_0D-Tuple{Union{Tuple, CompositeRheology, Parallel}, Number, Any}"><code>GeoParams.time_τII_0D</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">t_vec, τ_vec = time_τII_0D(v::CompositeRheology, εII::Number, args; t=(0.,100.), τ0=0., nt::Int64=100)</code></pre><p>This performs a 0D constant strainrate experiment for a composite rheology structure <code>v</code>, and a given, constant, strainrate <code>εII</code> and rheology arguments <code>args</code>. The initial stress <code>τ0</code>, the time range <code>t</code> and the number of timesteps <code>nt</code> can be modified </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GeoParams.time_τII_0D-Union{Tuple{T}, Tuple{N}, Tuple{Union{Tuple, CompositeRheology, Parallel}, Tuple{Vararg{T, N}}, Any}} where {N, T}" href="#GeoParams.time_τII_0D-Union{Tuple{T}, Tuple{N}, Tuple{Union{Tuple, CompositeRheology, Parallel}, Tuple{Vararg{T, N}}, Any}} where {N, T}"><code>GeoParams.time_τII_0D</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">t_vec, τ_vec = time_τII_0D(v::CompositeRheology, ε::NTuple{N,T}, args; t=(0.,100.), τ0=NTuple{N,T}, nt::Int64=100)</code></pre><p>This performs a 0D constant strainrate experiment for a composite rheology structure <code>v</code>, and a given, constant, strainrate tensor <code>ε</code> and rheology arguments <code>args</code>. The initial deviatoric stress tensor <code>τ</code>, the time range <code>t</code> and the number of timesteps <code>nt</code> can be modified </p></div></section></article><p>–&gt;</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parallelstencil/">« ParallelStencil</a><a class="docs-footer-nextpage" href="../license/">License »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 8 April 2023 21:49">Saturday 8 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
